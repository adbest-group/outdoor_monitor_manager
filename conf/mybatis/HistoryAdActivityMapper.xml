<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bt.om.mapper.HistoryAdActivityMapper" >
  <resultMap id="BaseResultMap" type="com.bt.om.entity.HistoryAdActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 18 14:25:00 CST 2018.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="activity_name" property="activityName" jdbcType="VARCHAR" />
    <result column="start_time" property="startTime" jdbcType="TIMESTAMP" />
    <result column="end_time" property="endTime" jdbcType="TIMESTAMP" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
	<result column="customer_type_id" property="customerTypeId" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="assessor_id" property="assessorId" jdbcType="INTEGER" />
    <result column="sample_pic_url" property="samplePicUrl" jdbcType="VARCHAR" />
    <result column="up_task_time" property="upTaskTime" jdbcType="VARCHAR" />
    <result column="up_monitor_task_time" property="upMonitorTaskTime" jdbcType="VARCHAR" />
    <result column="duration_monitor_task_time" property="durationMonitorTaskTime" jdbcType="VARCHAR" />
    <result column="down_monitor_task_time" property="downMonitorTaskTime" jdbcType="VARCHAR" />
    <result column="zhuijia_monitor_task_time" property="zhuijiaMonitorTaskTime" jdbcType="VARCHAR" />
    <result column="up_task_point" property="upTaskPoint" jdbcType="INTEGER" />
    <result column="up_monitor_task_point" property="upMonitorTaskPoint" jdbcType="INTEGER" />
    <result column="duration_monitor_task_point" property="durationMonitorTaskPoint" jdbcType="INTEGER" />
    <result column="down_monitor_task_point" property="downMonitorTaskPoint" jdbcType="INTEGER" />
    <result column="zhuijia_monitor_task_point" property="zhuijiaMonitorTaskPoint" jdbcType="INTEGER" />
    <result column="up_task_money" property="upTaskMoney" jdbcType="DOUBLE" />
    <result column="up_monitor_task_money" property="upMonitorTaskMoney" jdbcType="DOUBLE" />
    <result column="duration_monitor_task_money" property="durationMonitorTaskMoney" jdbcType="DOUBLE" />
    <result column="down_monitor_task_money" property="downMonitorTaskMoney" jdbcType="DOUBLE" />
    <result column="zhuijia_monitor_task_money" property="zhuijiaMonitorTaskMoney" jdbcType="DOUBLE" />
    <result column="qualified_pic_url" property="qualifiedPicUrl" jdbcType="VARCHAR" />
    <result column="no_qualified_pic_url1" property="noQualifiedPicUrl1" jdbcType="VARCHAR" />
    <result column="no_qualified_pic_url2" property="noQualifiedPicUrl2" jdbcType="VARCHAR" />
    <result column="no_qualified_pic_url3" property="noQualifiedPicUrl3" jdbcType="VARCHAR" />
    <result column="no_qualified_text1" property="noQualifiedText1" jdbcType="VARCHAR" />
    <result column="no_qualified_text2" property="noQualifiedText2" jdbcType="VARCHAR" />
    <result column="no_qualified_text3" property="noQualifiedText3" jdbcType="VARCHAR" />
    <result column="notification" property="notification" jdbcType="VARCHAR"/>
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 18 14:25:00 CST 2018.
    -->
    id, activity_name, start_time, end_time, status, user_id, customer_type_id, create_time, update_time, assessor_id, sample_pic_url,
    up_task_time, up_monitor_task_time, duration_monitor_task_time, down_monitor_task_time, zhuijia_monitor_task_time,up_task_point,
    up_monitor_task_point,duration_monitor_task_point,down_monitor_task_point,zhuijia_monitor_task_point,up_task_money,up_monitor_task_money,duration_monitor_task_money,
    down_monitor_task_money,zhuijia_monitor_task_money,qualified_pic_url,no_qualified_pic_url1,no_qualified_pic_url2,no_qualified_pic_url3,no_qualified_text1,no_qualified_text2,
    no_qualified_text3,notification
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 18 14:25:00 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from history_ad_activity_${tableName}
    where id = #{activityId,jdbcType=INTEGER}
  </select>
  <insert id="insertSelective" parameterType="com.bt.om.entity.HistoryAdActivity" useGeneratedKeys="true" keyProperty="id" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 18 14:25:00 CST 2018.
    -->
    insert into history_ad_activity_${tableName}
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="activityName != null" >
        activity_name,
      </if>
      <if test="startTime != null" >
        start_time,
      </if>
      <if test="endTime != null" >
        end_time,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
	  <if test="customerTypeId != null" >
        customer_type_id,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
      <if test="updateTime != null" >
        update_time,
      </if>
       <if test="assessorId != null" >
        assessor_id,
      </if>
      <if test="samplePicUrl != null" >
        sample_pic_url,
      </if>
      <if test="upTaskTime != null" >
        up_task_time,
      </if>
      <if test="upMonitorTaskTime != null" >
        up_monitor_task_time,
      </if>
      <if test="durationMonitorTaskTime != null" >
        duration_monitor_task_time,
      </if>
      <if test="downMonitorTaskTime != null" >
        down_monitor_task_time,
      </if>
      <if test="zhuijiaMonitorTaskTime != null" >
        zhuijia_monitor_task_time,
      </if>
      <if test="upTaskPoint != null" >
        up_task_point,
      </if>     
      <if test="upMonitorTaskPoint != null" >
        up_monitor_task_point,
      </if>
      <if test="durationMonitorTaskPoint != null" >
        duration_monitor_task_point,
      </if>
      <if test="downMonitorTaskPoint != null" >
        down_monitor_task_point,
      </if>
      <if test="zhuijiaMonitorTaskPoint != null" >
        zhuijia_monitor_task_point,
      </if>
      <if test="upTaskMoney != null" >
        up_task_money,
      </if>     
      <if test="upMonitorTaskMoney != null" >
        up_monitor_task_money,
      </if>
      <if test="durationMonitorTaskMoney != null" >
        duration_monitor_task_money,
      </if>
      <if test="downMonitorTaskMoney != null" >
        down_monitor_task_money,
      </if>
       <if test="zhuijiaMonitorTaskMoney != null" >
        zhuijia_monitor_task_money,
      </if>
      <if test="qualifiedPicUrl != null">
      	qualified_pic_url,
      </if>
      <if test="noQualifiedPicUrl1 != null">
      	no_qualified_pic_url1,
      </if>
      <if test="noQualifiedPicUrl2 != null">
      	no_qualified_pic_url2,
      </if>
      <if test="noQualifiedPicUrl3 != null">
      	no_qualified_pic_url3,
      </if>
      <if test="noQualifiedText1 != null">
      	no_qualified_text1,
      </if>
      <if test="noQualifiedText2 != null">
      	no_qualified_text2,
      </if>
      <if test="noQualifiedText3 != null">
      	no_qualified_text3,
      </if>
      <if test="notification != null">
      	notification
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="activityName != null" >
        #{activityName,jdbcType=VARCHAR},
      </if>
      <if test="startTime != null" >
        #{startTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null" >
        #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=INTEGER},
      </if>
	  <if test="customerTypeId != null" >
        #{customerTypeId,jdbcType=INTEGER},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="assessorId != null" >
        #{assessorId,jdbcType=INTEGER},
      </if>
      <if test="samplePicUrl != null" >
        #{samplePicUrl,jdbcType=VARCHAR},
      </if>
      <if test="upTaskTime != null" >
        #{upTaskTime,jdbcType=VARCHAR},
      </if>
      <if test="upMonitorTaskTime != null" >
        #{upMonitorTaskTime,jdbcType=VARCHAR},
      </if>
      <if test="durationMonitorTaskTime != null" >
        #{durationMonitorTaskTime,jdbcType=VARCHAR},
      </if>
      <if test="downMonitorTaskTime != null" >
        #{downMonitorTaskTime,jdbcType=VARCHAR},
      </if>
      <if test="zhuijiaMonitorTaskTime != null" >
        #{zhuijiaMonitorTaskTime,jdbcType=VARCHAR},
      </if>
      <if test="upTaskPoint != null" >
        #{upTaskPoint,jdbcType=INTEGER},
      </if>
      <if test="upMonitorTaskPoint != null" >
        #{upMonitorTaskPoint,jdbcType=INTEGER},
      </if>
      <if test="durationMonitorTaskPoint != null" >
        #{durationMonitorTaskPoint,jdbcType=INTEGER},
      </if>
      <if test="downMonitorTaskPoint != null" >
        #{downMonitorTaskPoint,jdbcType=INTEGER},
      </if>
       <if test="zhuijiaMonitorTaskPoint != null" >
        #{zhuijiaMonitorTaskPoint,jdbcType=INTEGER},
      </if>
      <if test="upTaskMoney != null" >
        #{upTaskMoney,jdbcType=DOUBLE},
      </if>
      <if test="upMonitorTaskMoney != null" >
        #{upMonitorTaskMoney,jdbcType=DOUBLE},
      </if>
      <if test="durationMonitorTaskMoney != null" >
        #{durationMonitorTaskMoney,jdbcType=DOUBLE},
      </if>
      <if test="downMonitorTaskMoney != null" >
        #{downMonitorTaskMoney,jdbcType=DOUBLE},
      </if>
      <if test="zhuijiaMonitorTaskMoney != null" >
        #{zhuijiaMonitorTaskMoney,jdbcType=DOUBLE},
      </if>
      <if test="qualifiedPicUrl != null" >
        #{qualifiedPicUrl,jdbcType=VARCHAR},
      </if>
      <if test="noQualifiedPicUrl1 != null" >
        #{noQualifiedPicUrl1,jdbcType=VARCHAR},
      </if>
      <if test="noQualifiedPicUrl2 != null" >
        #{noQualifiedPicUrl2,jdbcType=VARCHAR},
      </if>
      <if test="noQualifiedPicUrl3 != null" >
        #{noQualifiedPicUrl3,jdbcType=VARCHAR},
      </if>
         <if test="noQualifiedText1 != null" >
        #{noQualifiedText1,jdbcType=VARCHAR},
      </if>
      <if test="noQualifiedText2 != null" >
        #{noQualifiedText2,jdbcType=VARCHAR},
      </if>
      <if test="noQualifiedText3 != null" >
        #{noQualifiedText3,jdbcType=VARCHAR},
      </if>
       <if test="notification != null" >
        #{notification,jdbcType=VARCHAR}
      </if>
    </trim>
  </insert>

  <resultMap id="ExtResultMap" extends="BaseResultMap" type="com.bt.om.entity.vo.AdActivityVo">
    <!--<result column="name" jdbcType="INTEGER" property="name" />-->
    <!--<result column="telephone" jdbcType="INTEGER" property="telephone" />-->
    <!--<result column="role_name" jdbcType="INTEGER" property="roleName" />-->
    <!--<collection property="activityAreas" column="id" javaType="list" select="com.bt.om.mapper.AdActivityAreaMapper.selectByActivityId"></collection>-->
    <!--<collection property="activitySeats" column="id" select="com.bt.om.mapper.AdActivityAdseatMapper.selectByActivityId"></collection>-->
    <!--<collection property="activityMedias" column="id" select="com.bt.om.mapper.AdActivityMediaMapper.selectByActivityId"></collection>-->
  </resultMap>
  
  <resultMap id="ExtResultMap2" extends="BaseResultMap" type="com.bt.om.entity.vo.AdActivityVo2">
    <result column="realname" jdbcType="VARCHAR" property="realName" />
    <result column="customerName" jdbcType="VARCHAR" property="customerName" />
    <result column="media_type_parent_id" jdbcType="INTEGER" property="mediaTypeParentId"/>
    <result column="media_type_id" jdbcType="INTEGER" property="mediaTypeId"/>
    <result column="province" jdbcType="BIGINT" property="province"/>
    <result column="city" jdbcType="BIGINT" property="city"/>
    <result column="parentName" jdbcType="VARCHAR" property="parentName"/>
	<result column="secondName" jdbcType="VARCHAR" property="secondName"/>
  </resultMap>

  <!-- 后台查询活动信息 分页 -->
  <select id="getPageCount" parameterType="map" resultType="int">
    select
    count(a.id)
    from
    history_ad_activity_${tableName} a 
    	left join sys_user b on a.assessor_id = b.id
    	left join sys_user c on a.user_id = c.id
    where 1=1
    <if test="userId != null" >
      and a.user_id = #{userId,jdbcType=INTEGER}
    </if>
    <if test="activityName != null">
      and a.activity_name like #{activityName,jdbcType=VARCHAR}
    </if>
    <if test="activityId != null" >
      and a.id = #{activityId,jdbcType=INTEGER}
    </if>
    <if test="status != null" >
      and a.status = #{status,jdbcType=INTEGER}
    </if>
    <if test="startDate != null" >
      and a.start_time >= DATE_FORMAT(#{startDate,jdbcType=TIMESTAMP},'%Y-%m-%d')
    </if>
    <if test="endDate != null" >
      and a.end_time &lt;= DATE_FORMAT(#{endDate,jdbcType=TIMESTAMP},'%Y-%m-%d')
    </if>
    <if test="assessorId != null" >
      and a.assessor_id = #{assessorId,jdbcType=INTEGER}
    </if>
    <if test="samplePicUrl != null" >
      and a.sample_pic_url = #{samplePicUrl,jdbcType=VARCHAR}
    </if>
    <if test="customerIds != null">
      and a.user_id in
        <foreach collection="customerIds" separator="," open="(" close=")" item="id">#{id,jdbcType=INTEGER}</foreach>
    </if>
  </select>

  <!-- 后台查询活动信息 分页 -->
  <select id="getPageData" parameterType="map" resultMap="ExtResultMap2">
    select
    	a.id, a.activity_name, a.start_time, a.end_time, a.status, a.user_id, a.create_time, a.update_time, a.assessor_id,
    	b.realname,
    	c.realname customerName
    from
    	history_ad_activity_${tableName} a 
    	left join sys_user b on a.assessor_id = b.id
    	left join sys_user c on a.user_id = c.id
    where 1=1
    <if test="userId != null" >
      and a.user_id = #{userId,jdbcType=INTEGER}
    </if>
    <if test="activityName != null">
      and a.activity_name like #{activityName,jdbcType=VARCHAR}
    </if>
    <if test="activityId != null" >
      and a.id = #{activityId,jdbcType=INTEGER}
    </if>
    <if test="status != null" >
      and a.status = #{status,jdbcType=INTEGER}
    </if>
    <if test="startDate != null" >
      and a.start_time >= DATE_FORMAT(#{startDate,jdbcType=TIMESTAMP},'%Y-%m-%d')
    </if>
    <if test="endDate != null" >
      and a.end_time &lt;= DATE_FORMAT(#{endDate,jdbcType=TIMESTAMP},'%Y-%m-%d')
    </if>
    <if test="assessorId != null" >
      and a.assessor_id = #{assessorId,jdbcType=INTEGER}
    </if>
    <if test="customerIds != null">
      and a.user_id in
        <foreach collection="customerIds" separator="," open="(" close=")" item="id">#{id,jdbcType=INTEGER}</foreach>
    </if>
    order by a.id desc
  </select>

  <!-- 通过活动id查询活动的基础信息 -->
  <select id="selectVoByPrimaryKey" resultMap="ExtResultMap" parameterType="map" >
    select
    <include refid="Base_Column_List" />
    from history_ad_activity_${tableName}
    where id = #{id,jdbcType=INTEGER}
  </select>

  <resultMap id="MobileReportMap" extends="BaseResultMap" type="com.bt.om.entity.vo.ActivityMobileReportVo" >
    <id column="delivery_num" property="deliveryNum" jdbcType="INTEGER" />
    <result column="monitor_num" property="monitorNum" jdbcType="INTEGER" />
    <result column="error_num" property="errorNum" jdbcType="INTEGER" />
  </resultMap>
</mapper>